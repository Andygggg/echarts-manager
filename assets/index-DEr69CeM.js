var p=Object.defineProperty;var f=(a,e,n)=>e in a?p(a,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[e]=n;var c=(a,e,n)=>f(a,typeof e!="symbol"?e+"":e,n);import{g,i as y,L as u}from"./echarts-Dn_kwerC.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(t){if(t.ep)return;t.ep=!0;const s=n(t);fetch(t.href,s)}})();class C{constructor(){c(this,"chartInstances",new Map);c(this,"resizeHandler",null)}async spawnChart(e,n){return new Promise(r=>{setTimeout(()=>{const t=document.getElementById(e);if(!t){r(void 0);return}const i=g(t)||y(t);i.setOption(n),this.chartInstances.set(e,i),r(i)},0)})}async spawnCharts(e){return await Promise.all(e.map(async({id:r,option:t})=>{const s=await this.spawnChart(r,t);return{id:r,echartsInstance:s}}))}async updateChartOption(e,n,r){return new Promise(t=>{const s=this.chartInstances.get(e);s?(s.setOption(n,r),t({id:e,success:!0,echartsInstance:s})):t({id:e,success:!1,echartsInstance:s})})}async updateAllCharts(e,n){const r=[];return Array.isArray(e)?e.forEach(({id:t,option:s})=>{const i=this.updateChartOption(t,s,n);r.push(i)}):Object.entries(e).forEach(([t,s])=>{const i=this.updateChartOption(t,s,n);r.push(i)}),Promise.all(r)}resizeCharts(){this.chartInstances.forEach(e=>e.resize())}setupResizeListener(e=300){this.resizeHandler||(this.resizeHandler=()=>{this.debounce(()=>{this.resizeCharts()},e)()},window.addEventListener("resize",this.resizeHandler))}dispose(){this.resizeHandler&&window.removeEventListener("resize",this.resizeHandler),this.chartInstances.forEach((e,n)=>{e.dispose(),this.chartInstances.delete(n)})}debounce(e,n){let r=null;return()=>{r&&clearTimeout(r),r=setTimeout(()=>{e(),r=null},n)}}getChart(e){return this.chartInstances.get(e)}}const b=()=>{const a=new C;return a.setupResizeListener(),a},o=b(),E={title:{text:"圓餅圖",left:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"vertical",left:"left"},animation:!0,animationDuration:1e3,animationEasing:"cubicInOut",series:[{name:"value",type:"pie",radius:"50%",data:[{value:1048,name:"A"},{value:735,name:"B"},{value:580,name:"C"},{value:484,name:"D"},{value:300,name:"E"}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},v={title:{text:"長條圖",left:"center"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:["A","B","C","D","E","F","G"],axisTick:{alignWithLabel:!0}},yAxis:{type:"value"},animation:!0,animationDuration:1e3,animationEasing:"cubicInOut",series:[{name:"value",type:"bar",barWidth:"60%",data:[150,230,224,218,135,147,260],itemStyle:{color:new u(0,0,0,1,[{offset:0,color:"#83bff6"},{offset:.5,color:"#188df0"},{offset:1,color:"#188df0"}])}}]},I={title:{text:"折線圖",left:"center"},tooltip:{trigger:"axis"},legend:{data:["value"],top:30},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:["A","B","C","D","E","F","G"]},yAxis:{type:"value"},animation:!0,animationDuration:1e3,animationEasing:"cubicInOut",series:[{name:"value",type:"line",data:[820,932,901,934,1290,1330,1320],areaStyle:{color:new u(0,0,0,1,[{offset:0,color:"rgba(128, 255, 165, 0.5)"},{offset:1,color:"rgba(1, 191, 236, 0)"}])},smooth:!0}]},O=document.getElementById("generateBtn"),w=document.getElementById("destroyBtn"),l=document.getElementById("chartSelector"),d=document.getElementById("updateSingleBtn"),B=document.getElementById("updateAllBtn"),h=async()=>{try{const a=await o.spawnCharts([{id:"pieChart",option:E},{id:"barChart",option:v},{id:"lineChart",option:I}]);console.log(a)}catch(a){console.error("生成圖表時發生錯誤：",a)}},L=()=>{try{o.dispose()}catch(a){console.error("銷毀圖表時發生錯誤：",a)}},m=()=>({pieChart:{animation:!0,animationDuration:1e3,animationEasing:"cubicInOut",series:[{data:[{value:Math.random()*1e3,name:"範例A"},{value:Math.random()*1e3,name:"範例B"},{value:Math.random()*1e3,name:"範例C"},{value:Math.random()*1e3,name:"範例D"},{value:Math.random()*1e3,name:"範例E"}]}]},barChart:{animation:!0,animationDuration:1e3,animationEasing:"cubicInOut",series:[{data:Array.from({length:7},()=>Math.floor(Math.random()*300))}]},lineChart:{animation:!0,animationDuration:1e3,animationEasing:"cubicInOut",series:[{data:Array.from({length:7},()=>Math.floor(Math.random()*1500))}]}}),A=()=>{d.disabled=!l.value},x=async()=>{const a=l.value;if(a)try{const e=m(),n=await o.updateChartOption(a,e[a]);console.log(n)}catch(e){console.error("更新圖表時發生錯誤：",e)}},z=async()=>{try{const a=m(),e=await o.updateAllCharts(a);console.log(e);const n=e.filter(r=>!r.success);n.length>0&&alert(`更新圖表 ${n.map(r=>r.id).join(", ")} 失敗`)}catch(a){console.error("更新圖表時發生錯誤：",a)}};l.addEventListener("change",A);d.addEventListener("click",x);B.addEventListener("click",z);O.addEventListener("click",h);w.addEventListener("click",L);h();
